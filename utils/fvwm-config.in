#!/bin/sh

# Querying fvwm installation. Author: Mikhael Goikhman.

PACKAGE="@PACKAGE@"
VERSION="@VERSION@"
script=`basename $0`

usage()
{
	cat <<EOF
This script is a part of $PACKAGE-$VERSION package.

Usage: $script [OPTIONS]
Options:
	[-h]	[--help]
	[-v]	[--version]
	[-i]	[--info]

	[-P]	[--prefix]
	[-E]	[--exec-prefix]
	[-B]	[--bindir]
	[-L]	[--libexecdir]
	[-S]	[--sysconfdir]
	[-M]	[--mandir]

	[-m]	[--moduledir]
	[-c]	[--configdir]
	[-I]	[--default-imagepath]
	[-U]	[--default-userhome]

	[-s]	[--supports] - list supported features, one per line
	[--supports-<feature>] - return: 0 (yes), 100 (no), 200 (unknown)
EOF
	exit $1
}

if test $# -eq 0; then
	usage 1 1>&2
fi

prefix="@prefix@"
exec_prefix="@exec_prefix@"
bindir="@bindir@"
libexecdir="@libexecdir@"
sysconfdir="@sysconfdir@"
mandir="@mandir@"

moduledir="@FVWM_MODULEDIR@"
configdir="@FVWM_CONFIGDIR@"
imagepath="@FVWM_IMAGEPATH@"
userhome='$HOME'

with_readline=@with_readline@
with_rplay=@with_rplay@
with_stroke=@with_stroke@
with_xpm=@with_xpm@
with_gtk=@with_gtk@
with_sm=@with_sm@

while test $# -gt 0; do
	case "$1" in
		--help|-help|-h)
			usage 0 ;;

		--version|-version|-v)
			echo "$VERSION" ;;

		--prefix|-prefix|-P)
			echo "$prefix" ;;

		--exec-prefix|-exec-prefix|-E)
			echo "$exec_prefix" ;;

		--bindir|-bindir|-B)
			echo "$bindir" ;;

		--libexecdir|-libexecdir|-L)
			echo "$libexecdir" ;;

		--sysconfdir|-sysconfdir|-S)
			echo "$sysconfdir" ;;

		--mandir|-mandir|-M)
			echo "$mandir" ;;

		--moduledir|-moduledir|-m)
			echo "$moduledir" ;;

		--configdir|-configdir|-c)
			echo "$configdir" ;;

		--default-imagepath|-default-imagepath|-I)	
			echo "$imagepath" ;;

		--default-userhome|-default-userhome|-U)
			echo "$userhome" ;;

		--supports|-supports|-s)
			test "$with_readline" = "yes" && echo "readline"
			test "$with_rplay"    = "yes" && echo "rplay"
			test "$with_stroke"   = "yes" && echo "stroke"
			test "$with_xpm"      = "yes" && echo "xpm"
			test "$with_gtk"      = "yes" && echo "gtk"
			test "$with_sm"       = "yes" && echo "sm"
			;;

		--supports-*)
			feature=`echo "$1" | sed 's/^--supports-//'`
			with=`eval echo '$'with_"$feature"`
			test "$with" = "yes" && exit 0
			test "$with" = "no"  && exit 100
			exit 200
			;;

		--info|-info|-i)
			echo "Package: $PACKAGE"
			echo "Version: $VERSION"
			echo ""
			echo "Instalation options:"
			echo "	prefix: $prefix"
			echo "	exec-prefix: $exec_prefix"
			echo "	bindir: $bindir"
			echo "	libexecdir: $libexecdir"
			echo "	sysconfdir: $sysconfdir"
			echo "	mandir: $mandir"
			echo ""
			echo "Compiled-in paths:"
			echo "	Module directory: $moduledir"
			echo "	Configuration directory: $configdir"
			echo "	Default ImagePath: $imagepath"
			echo "	Default UserHome: $userhome"
			echo ""
			echo "Support for features:"
			echo "	readline: $with_readline"
			echo "	rplay: $with_rplay"
			echo "	stroke: $with_stroke"
			echo "	xpm: $with_xpm"
			echo "	gtk: $with_gtk"
			echo "	sm (session management): $with_sm"
			;;

		*)
			echo "$script: unknown parameter [$1]" 1>&2
			exit 1
			;;

	esac
	shift
done

exit 0
