#%define prefix %{_prefix}
%define prefix /usr

%define ver @VERSION@
%define rel 1
%define c_p --disable-multibyte
%define m_p CFLAGS="-O2"

# Different distributions expect sources to be in different places;
# the following solves this problem, but makes it hardier to reuse .src.rpm
%define _sourcedir /tmp

Summary:   F(?) Virtual Window Manager
Name:      fvwm
Version:   %{ver}
Release:   %{rel}
Copyright: GPL
Group:     X11/Window Managers
Source:    %{name}-%{version}.tar.gz
URL:       http://www.fvwm.org/
BuildRoot: %{_tmppath}/%{name}-%{version}-root
Packager:  FVWM Workers <fvwm-workers@fvwm.org>
Autoreq:   1

Requires:  libXpm.so.4
#Requires:  xpm >= 3.4g
Requires:  perl >= 5.002

# GTK, Imlib, stroke

# RedHat should stop using name "fvwm" to refer to fvwm1 package.
Provides:  fvwm, fvwm2

Docdir:    %{prefix}/share/doc

%description
FVWM is a powerful ICCCM-compliant multiple virtual desktop window manager
for the X Window System.

This 2.4 version includes new features like colorsets, ICCCM2 and GNOME
compliance, session management, improvements in all modules, several
new modules, revised menu code, stroke support and much more.

### to be translated
%description -l fr
FVWM est un powerful ICCCM-compliant multiple virtual desktop window manager
for the X Window System.

This 2.4 version contient des new features like colorsets, ICCCM2 and GNOME
compliance, session management, improvements in all modules, several
new modules, revised menu code, stroke support and much more.

%description -l ru
FVWM является мощным оконным менеджером для X Window System, соответствующим
стандартам ICCCM, с поддержкой множественных виртульных десктопов.

Версия 2.4 включает в себя новые особенности, такие как цветовые комплекты
(colorsets), соответствие ICCCM2 и совместимость с GNOME, управление сессий,
улучшения во всех модулях, несколько новых модулей, переработанный код меню,
поддержка stroke и многое другое.

%prep
%setup

%build
# gnome libs are only used in FvwmGtk, probably it is overhead to require it
# compiling without -g saves about 7Mb
./configure --prefix=%{prefix} %{c_p}
make %{m_p}

%install
rm -rf $RPM_BUILD_ROOT
make prefix=$RPM_BUILD_ROOT%{prefix} install

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-, root, root)

%doc AUTHORS COPYING INSTALL INSTALL.fvwm NEWS README
%doc docs/ANNOUNCE docs/BUGS docs/DEVELOPERS docs/FAQ docs/TODO
%doc docs/color_combos docs/error_codes docs/fvwm.lsm docs/m4_hacks
%{prefix}/bin/*
%{prefix}/libexec/*
%{prefix}/man/*/*
%{prefix}/share/*

## TODO: how to specify the current date in .spec? Or how to run a `command`?
#%changelog
#
#* Wed 12 May 2000 20:00:00 IDT  FVWM Workers  <fvwm-workers@fvwm.org>
#- Auto building %{PACKAGE_VERSION}
#
#* Wed 12 May 2000 20:00:00 IDT  Mikhael Goikhman  <migo@homemail.com>
#- First try at making the package
